---
title: 操作系统概述
date: 2022-07-13 09:13:20
img: /medias/featureimages/xxx.png
author: Jarrycow
cover: false
top: false
mathjax: true
categories:
  - 操作系统
tags:
  - 操作系统
abbrlink: OS
---


# 操作系统定义

**操作系统**：**管理**整个计算机系统的**硬件和软件**资源，并合理地组织调度计算机的工作和资源的分配；**以提供给用户和其他软件方便的接口和环境**；它是计算机系统中**最基本**的系统软件

- 是系统资源的**管理者**
- 是**最接近硬件**的一层**软件**
- 向上层提供方便易用的**服务**

**加载位置：**RAM

## 操作系统特征

**最基本特征：**并发、共享

**并发 & 共享**

- 共享以并发为条件<sub>若不允许并发，自然不存在共享问题</sub>
- 若系统无法实施有效共享管理，将影响并发执行

### 并发

同时存在多个运行程序

- 宏观上有多道程序**同时**执行

  微观上每时刻单处理机实际**仅有一道**程序执行

- 并发性通过**分时**实现

**并发 & 并行**

- 并发微观上**交替进行**，通过**分时**实现
- 并行**同时**完成多种工作，需要**硬件支持**<sub>多流水线/多处理机</sub>

> 多道程序设计特征
>
> - 制约性
> - 间断性
> - 共享性
> - <del>封闭性</del>
> - <del>顺序性</del>

### 共享

系统资源可供多个并发进程共同使用

**互斥共享方式：**同一时段只允许**一个进程**访问

- **临界资源：**只允许一个进程访问的资源
- 大多数物理设备、软件中变量、栈

**同时访问方式：**允许多个进程**宏观上同时**访问

- 磁盘资源

### 虚拟

**虚拟技术：**将物理实体变为逻辑对应物

- 时分复用<sub>处理器分时共享</sub>
- 空分复用<sub>虚拟存储器</sub>

### 异步

并发程序以不可预知速度推进

## 操作系统目标 & 功能

### 计算机系统管理者

**处理机管理：**对进程管理

**存储器管理：**给并发运行提供环境

**文件管理：**负责文件管理

**设备管理：**I/O请求

### 用户和硬件系统接口

**命令接口：**进行作业控制

- **联机命令接口：**（交互式命令接口）输入命令，做出反馈
- **脱机命令接口：**（批处理命令接口）一组作业控制命令

>  **操作系统与用户通信接口**
>
> 广义指令：即系统调用命令
>
> 命令解释器
>
> shell：命令解析器

**程序接口：**一组系统调用

- 系统调用：提供给应用程序接口，只能通过用户程序间接使用
- 用户调用程序接口**请求系统服务**

> **库函数 & 系统调用**
>
> - 库函数是**语言或应用程序**一部分
>
>   系统调用是**操作系统**一部分
>
> - 库函数运行**用户空间**中
>
>   系统调用运行**内核空间**中
>
> - 许多库函数会使用系统调用实现
>
> - 库函数<sub>未使用系统调用</sub>执行效率比系统调用高<sub>系统调用状态切换</sub>

### 用作扩充机器

将裸机改造功能更强

# 操作系统发展 & 分类

## 发展

### 手工操作阶段

**缺点**

- 用户独占全机，资源利用效率低
- CPU全手工操作，CPU利用不充分

### 单道批处理系统

内存始终保持一道作业

**特征**

- **自动性**
- **顺序性**
- **单道性**

**缺点：**运行期间发出I/O请求后，高速CPU处于等待低速I/O状态

> **中断 & 通道对多道程序作用**
>
> 多道程序并发即有的程序在CPU执行，有的在I/O设备传输，必须中断和通道技术支持
>
> - **通道：**控制外部设备的硬件机构，独立于CPU运行，因而可以使得CPU与I/O并行工作
> - **中断：**I/O结束或硬件故障时，由中断机构告知CPU停止工作，处理中断请求，待处理完中断再继续工作

### 多道批处理系统

**特点**

- 多道
- 宏观并行
- 微观串行

**问题**

- 处理器分配
- 内存分配
- I/O设备分配
- 组织和存放大量程序和数据，保证安全性和一致性

**优点**

- 资源利用效率高
- 系统吞吐量大

**缺点**

- 用户响应时间较长
- 不提供人机交互能力

## 分类

- **批处理操作系统**

  用户脱机使用计算机

  作业成批处理，系统内并发执行多道程序

  交互能力差

- **分时操作系统**

  多个用户同时使用计算机

  交互性强

  具有每个用户独立使用计算机的独占性

  系统响应及时

- **实时操作系统**

  控制对象做出及时响应

  可靠性高，响应及时

  资源利用率低

### 分时操作系统

多个用户通过终端共享主机

**调度算法：**优先级+非抢占式调度

**目标：**比较快速响应用户

**特点**

- 同时性
- 交互性
- 独立性
- 及时性

### 实时操作系统

某个时间限制内完成紧急任务

**进程调度：**抢占式的优先级高者优先算法

- **硬实时系统：**某动作必须在规定时刻发生<sub>飞行自动控制系统</sub>
- **软实时系统：**可偶尔违反时间规定<sub>飞机订票系统</sub>

**特点**

- 及时性
- 可靠性

### 网络操作系统 & 分布式计算机系统

**网络操作系统：**通过网络使各计算机有机结合

- **特点：**通信、共享

**分布式计算及系统：**通信计算机地位平等

- **特点：**分布性、并行性

**不同：**分布式计算及系统中若干计算机协同完成同一任务

# 操作系统运行环境

## 运行机制

**特权指令：**不允许用户直接使用的指令，必须在**核心态**执行

- 清理内存
- 置时钟
- 分配系统资源
- 修改虚存表
- 修改用户权限

**访管指令：**在**用户态**下要求操作**系统提供服务**的指令，引起**访管中断**，进入内核

具体实现：将CPU划分为**用户态**和**内核态**

**区分两态的目的：**保护系统程序

### 内核

- 与硬件关联紧密的模块
- 运行频率较高的程序

**时间管理**

- 向用户提供标准系统时间
- 实现进程切换

**中断机制**

- 提高CPU利用率

**原语**

- 最接近硬件
- 原子性
- 运行时间较短、调用频繁

**系统控制的数据结构及处理**

- 进程管理
- 存储器管理
- 设备管理

## 中断 & 异常

用户态$\rightarrow$内核
$$
\text{中断}\left\{ \begin{array}{l}
	\text{内中断}\left\{ \begin{array}{l}
	\text{自愿中断}——\text{指令中断}\\
	\text{强迫中断}\left\{ \begin{array}{l}
	\text{硬件故障}\\
	\text{软件中断}\\
\end{array} \right.\\
\end{array} \right.\\
	\text{外中断}\left( \text{强迫中断} \right) \left\{ \begin{array}{l}
	\text{外设请求}\\
	\text{人为干预}\\
\end{array} \right.\\
\end{array} \right.
$$
**中断**（外中断）：来自CPU执行指令以外事情发生

**异常**（内中断/陷入）：CPU执行内部事件引起

### 中断处理

1. 关中断
2. 保存断点<sub>PC & PSW</sub>
3. 中断服务程序寻址
4. 保存现场和屏蔽字
5. 开中断
6. 执行中断服务程序
7. 关中断
8. 恢复现场和屏蔽字
9. 开中断、中断返回

## 系统调用

用户调用操作系统提供子功能

- 设备管理
- 文件管理
- 进程控制
- 进程通信
- 内存管理

![](https://note.youdao.com/yws/public/resource/184d98d8660f6c8c5e0ceb402e6f6258/xmlnote/AC4767A8641143708B57BE104726F506/69243.png)

> 用户态到核心态转换由**硬件**完成

## 体系结构

**大内核：**操作系统主要功能整体置于核心态

**微内核：**内核仅保留最基础功能

- **优点**
  - 添加系统服务，不必修改内核
  - 系统更可靠
- **缺点**
  - 性能降低